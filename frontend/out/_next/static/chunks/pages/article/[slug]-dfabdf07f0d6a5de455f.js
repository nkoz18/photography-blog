(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[894],{5030:function(t,e,r){"use strict";var a=r(5893),i=r(7757),n=r.n(i),o=r(2137),l=r(7294),s=r(1422);e.Z=function(t){var e,r,i,c=t.image,u=(t.style,t.alt),d=(0,l.useState)(!0),f=d[0],g=d[1],h=(0,l.useState)(""),p=h[0],m=h[1],v=(0,l.useState)(!1),b=v[0],x=v[1],w=(0,l.useState)(0),y=w[0],j=w[1],k=(0,l.useRef)(null);(0,l.useEffect)((function(){var t;if(null!==c&&void 0!==c&&null!==(t=c.data)&&void 0!==t&&t.attributes){var e=(0,s.$0)(c);m(e),j(0)}return function(){p&&p.startsWith("blob:")&&URL.revokeObjectURL(p)}}),[c,p]);var _=function(){var t=(0,o.Z)(n().mark((function t(e){var r,a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e,{method:"GET",headers:{"Cache-Control":"no-cache"}});case 3:if(!(r=t.sent).ok){t.next=9;break}return t.next=7,r.blob();case 7:return a=t.sent,t.abrupt("return",URL.createObjectURL(a));case 9:throw new Error("HTTP ".concat(r.status));case 12:return t.prev=12,t.t0=t.catch(0),console.error("Fetch preload failed:",t.t0),t.abrupt("return",null);case 16:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}();if(null===c||void 0===c||null===(e=c.data)||void 0===e||!e.attributes)return null;var O=c.data.attributes.alternativeText,P=(null===c||void 0===c||null===(r=c.data)||void 0===r||null===(i=r.attributes)||void 0===i?void 0:i.width)>1e3,E=u||O||"";return(0,a.jsxs)("div",{className:"image-container ".concat(P?"article-cover-image-container":""),style:{position:"relative",width:"100%",height:"auto",maxWidth:"100%"},children:[f&&!P&&(0,a.jsx)("div",{style:{width:"100%",paddingBottom:"56.25%",backgroundColor:"#f5f5f5",backgroundImage:"url('/loader.gif')",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundSize:"50px 50px"}}),f&&P&&(0,a.jsx)("div",{className:"image-loader"}),b&&(0,a.jsx)("div",{className:"image-error",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#999",fontSize:"14px"},children:"Image failed to load"}),p&&!b&&(0,a.jsx)("img",{ref:k,src:p,alt:E,className:"image-transition ".concat(f?"image-loading":"image-loaded"),onLoad:function(){g(!1),x(!1);var t=function(){var t,e,r;if(null===c||void 0===c||null===(t=c.data)||void 0===t||!t.attributes)return null;var a=c.data.attributes,i=null;return null!==(e=a.provider_metadata)&&void 0!==e&&e.focalPoint?i=a.provider_metadata.focalPoint:null!==(r=a.formats)&&void 0!==r&&r.focalPoint?i=a.formats.focalPoint:a.focalPoint&&(i=a.focalPoint),i&&"number"===typeof i.x&&"number"===typeof i.y?{x:Math.max(0,Math.min(100,i.x)),y:Math.max(0,Math.min(100,i.y))}:null}();if(t&&k.current&&P){var e="".concat(t.x,"% ").concat(t.y,"%");k.current.style.setProperty("--focal-point",e);var r=k.current.getBoundingClientRect();console.log("Applied focal point: ".concat(e)),console.log("Image dimensions: ".concat(r.width,"x").concat(r.height)),console.log("Window dimensions: ".concat(window.innerWidth,"x").concat(window.innerHeight)),console.log("Is mobile viewport:",window.innerWidth<=768)}},onError:function(){var t=(0,o.Z)(n().mark((function t(e){var r,a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.error("Image failed to load:",p,e),g(!1),!(y<3)){t.next=17;break}return console.log("Retry attempt ".concat(y+1,"/3 for:"),p),t.next=6,_(p);case 6:if(!(r=t.sent)){t.next=13;break}return console.log("Using blob URL:",r),m(r),j(y+1),g(!0),t.abrupt("return");case 13:a="".concat(p.split("?")[0],"?t=").concat(Date.now(),"&retry=").concat(y+1),setTimeout((function(){m(a),j(y+1),g(!0)}),1e3*(y+1)),t.next=18;break;case 17:x(!0);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),style:P?{width:"100%",maxWidth:"100%",display:"block",objectFit:"cover"}:{width:"100%",height:"auto",maxWidth:"100%",display:"block"}})]})}},4625:function(t,e,r){"use strict";r.r(e),r.d(e,{__N_SSG:function(){return y},default:function(){return j}});var a=r(5893),i=r(6156),n=r(7757),o=r.n(n),l=r(2137),s=r(724),c=r.n(s),u=r(883),d=r(8292),f=r(5030),g=r(8303),h=r(5152),p=(r(1422),r(7294)),m=r(1163),v=r(4247),b=function(){var t=(0,p.useRef)(null),e=(0,p.useRef)(null);return(0,p.useEffect)((function(){var r=t.current,a=e.current;if(r&&a){var i=function(){var t=a.getBoundingClientRect();r.width=t.width,r.height=t.height,r.getContext("2d").clearRect(0,0,r.width,r.height),v.Z.canvas(r).rectangle(10,10,r.width-20,r.height-20,{stroke:"#ff007f",strokeWidth:3,roughness:2.5,fill:"#ff007f",fillStyle:"solid",fillWeight:1})};return i(),window.addEventListener("resize",i),function(){return window.removeEventListener("resize",i)}}}),[]),(0,a.jsxs)("div",{ref:e,className:"unlisted-notice-container",style:{position:"relative",marginBottom:"2rem",padding:"1.5rem 2rem",minHeight:"80px",maxWidth:"585px",margin:"2rem auto"},children:[(0,a.jsx)("canvas",{ref:t,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"}}),(0,a.jsxs)("div",{style:{position:"relative",zIndex:1,color:"white",fontWeight:"500",fontSize:"0.95rem",lineHeight:"1.5"},children:[(0,a.jsx)("span",{style:{marginRight:"0.5rem"},children:"\ud83d\udd12"}),"This article is unlisted and won't appear in search results or navigation. Only people with the direct link can view it."]})]})};function x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}var w=(0,h.default)((function(){return Promise.all([r.e(687),r.e(850),r.e(780),r.e(296)]).then(r.bind(r,2099))}),{ssr:!1,loadableGenerated:{webpack:function(){return[2099]},modules:["article/[slug].js -> ../../components/PhotoSwipeGallery"]}}),y=!0,j=function(t){var e,r,n=t.article,s=t.categories,h=t.global,v=(0,m.useRouter)(),y=(0,p.useState)(n),j=y[0],k=y[1],_=(0,p.useState)(!1),O=_[0],P=_[1];if((0,p.useEffect)((function(){var t,e,r,a,i;null!==j&&void 0!==j&&j.attributes&&(console.log("Article data structure:",j),j.attributes.gallery&&console.log("Article gallery:",j.attributes.gallery),j.attributes.images&&console.log("Article images:",j.attributes.images),console.log("Complete image data:",null===(t=j.attributes.image)||void 0===t||null===(e=t.data)||void 0===e?void 0:e.attributes),null!==(r=j.attributes.image)&&void 0!==r&&null!==(a=r.data)&&void 0!==a&&null!==(i=a.attributes)&&void 0!==i&&i.provider_metadata&&console.log("Provider metadata:",j.attributes.image.data.attributes.provider_metadata))}),[j]),(0,p.useEffect)((function(){(function(){var t=(0,l.Z)(o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(v.query.slug){t.next=2;break}return t.abrupt("return");case 2:return P(!0),t.prev=3,t.next=6,(0,u.I)("/articles",{bypassListedFilter:!0,filters:{slug:v.query.slug,publishedAt:{$notNull:!0}},populate:{image:{fields:["url","alternativeText","caption","width","height","formats","provider_metadata"]},gallery:{populate:{images:{fields:["url","alternativeText","caption","width","height","formats","provider_metadata"]},gallery_items:{populate:{image:{fields:["url","alternativeText","caption","width","height","formats","provider_metadata"]}}}}},author:{populate:{picture:{fields:["url"]}}},categories:{fields:["name","slug"]}}});case 6:if(!((e=t.sent).data.length>0)){t.next=11;break}k(e.data[0]),t.next=13;break;case 11:return v.replace("/404"),t.abrupt("return");case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(3),console.error("Error fetching fresh article data:",t.t0);case 18:return t.prev=18,P(!1),t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[3,15,18,21]])})));return function(){return t.apply(this,arguments)}})()()}),[v.query.slug]),!n&&!j)return(0,a.jsx)("div",{children:"Loading..."});var E=j||n;if(null===E||void 0===E||!E.attributes)return(0,a.jsx)("div",{children:"Article not found"});var N=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach((function(e){(0,i.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({metaTitle:E.attributes.title,metaDescription:E.attributes.description,shareImage:E.attributes.image,article:!0},!1===E.attributes.listed&&{metaRobots:"noindex, nofollow"});return(0,a.jsxs)(d.Z,{categories:s||[],children:[(0,a.jsx)(g.Z,{seo:N,global:h}),!1===E.attributes.listed&&(0,a.jsx)(b,{}),(0,a.jsx)("div",{className:"uk-section",children:(0,a.jsx)("div",{className:"uk-container uk-container-large",children:null!==E&&void 0!==E&&E.attributes?(0,a.jsxs)(a.Fragment,{children:[E.attributes.image&&(0,a.jsx)("div",{className:"article-cover-image",style:{marginBottom:"2rem",maxWidth:"100%",overflow:"hidden",minHeight:"300px"},children:(0,a.jsx)(f.Z,{image:E.attributes.image,alt:E.attributes.title||"Article featured image"})}),(0,a.jsx)("h1",{className:"uk-article-title",children:E.attributes.title}),(null===(e=E.attributes.author)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.attributes)&&(0,a.jsxs)("p",{className:"article-author",children:["by ",E.attributes.author.data.attributes.name]}),(0,a.jsx)("div",{className:"uk-article-content",children:(0,a.jsx)(c(),{source:E.attributes.content,escapeHtml:!1})}),O?(0,a.jsx)("div",{style:{textAlign:"center",padding:"2rem"},children:(0,a.jsx)("p",{children:"Loading latest gallery content..."})}):(0,a.jsx)(w,{galleryData:E.attributes.gallery,images:E.attributes.images})]}):(0,a.jsx)("div",{style:{textAlign:"center",padding:"4rem 0"},children:(0,a.jsx)("p",{children:"Loading article content..."})})})})]})}},615:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/[slug]",function(){return r(4625)}])}},function(t){t.O(0,[774,247,796,482,888,179],(function(){return e=615,t(t.s=e);var e}));var e=t.O();_N_E=e}]);